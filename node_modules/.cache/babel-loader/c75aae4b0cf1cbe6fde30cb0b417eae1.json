{"ast":null,"code":"import _slicedToArray from \"/Users/amandainnis/ReactProjects/react-site/portfolio/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/amandainnis/ReactProjects/react-site/portfolio/src/components/reusable/LineChart.js\";\nimport React, { createRef, useState, useRef, useEffect } from \"react\";\nimport * as d3 from \"d3\";\nimport * as moment from \"moment\"; // each charted value has a display name for tooltip\n// tooltip may or may not have a charted value\n// each line takes a\n\nexport default function LineChart(props) {\n  const chart = createRef();\n  let innerWidth;\n  const defaultHeight = 220;\n  var containerElement;\n  let YOYdiff;\n\n  const _useState = useState(props.data),\n        _useState2 = _slicedToArray(_useState, 2),\n        chartData = _useState2[0],\n        setChartData = _useState2[1]; // const [innerWidth, setInnerWidth] = useState();\n\n\n  const _useState3 = useState(props.valueArray),\n        _useState4 = _slicedToArray(_useState3, 2),\n        valueArray = _useState4[0],\n        setValueArray = _useState4[1]; // function getLineDiffValue(line0, lineTwo) {\n  //   return line0 == null || lineTwo == null ? null : line0 - lineTwo;\n  // }\n\n\n  function getYOYdiffColor(YOY) {\n    if (YOY < 0) {\n      return \"YOYred\";\n    } else {\n      return \"YOYgreen\";\n    }\n  }\n\n  function prepMaxVal(myData, myArrayOfKeys) {\n    let tempArr = [];\n    let tempStartVal = [];\n\n    for (let i = 0; i < myData.length; i++) {\n      // push whatever arr[j] is in the array as a key into\n      for (let j = 0; j < myArrayOfKeys.length; j++) {\n        if (myData[i][myArrayOfKeys[j]] !== null) {\n          tempArr.push(myData[i][myArrayOfKeys[j][\"dataKey\"]]);\n        }\n      }\n    }\n\n    return tempArr;\n  }\n\n  function getMaxVal(myData, myArrayOfKeys) {\n    // console.log(startVals, startValsRef);\n    let tempArr = prepMaxVal(myData, myArrayOfKeys);\n    let tempArrB = prepMaxVal(myData, myArrayOfKeys);\n    let tempMax = tempArr.reduce((a, b) => Math.max(a, b));\n    let tempMin = tempArrB.reduce((a, b) => Math.min(a, b));\n    return {\n      min: tempMin,\n      max: tempMax\n    };\n  }\n\n  function createChart(chartData, myArrayOfKeys, myID, numberFormatFn) {\n    containerElement = chart.current;\n    innerWidth = chart.current.clientWidth;\n    console.log(innerWidth);\n    containerElement.innerHTML = \"\";\n    let tempMinMax = getMaxVal(chartData, myArrayOfKeys);\n    let minVal = tempMinMax.min;\n    let maxVal = tempMinMax.max; // let currentMonth = getCurrentMonth();\n\n    let margin = {\n      top: 20,\n      right: 60,\n      bottom: 0,\n      left: 10\n    }; //////////////////////// Establish the reused vals and the bound functions  ////////////////////////\n\n    let width = Number.isNaN(parseInt(d3.select(containerElement).style(\"width\"))) ? 0 : parseInt(d3.select(containerElement).style(\"width\")) - margin.left - margin.right;\n    let height = 300 - margin.top;\n    let justBisect = d3.bisector(d => chartData.indexOf(d)).left; //////////////////////// Set the scales  ////////////////////////\n\n    let x = d3.scaleLinear().range([0, width]);\n    let y = d3.scaleLinear().range([height, 0]); // //////////////////////// Set the axis ////////////////////////\n\n    let xAxis = d3.axisBottom(x).ticks(innerWidth => {\n      if (innerWidth < 450) {\n        return 4;\n      }\n    }).tickFormat(function (d) {\n      return chartData[d].niceDateAbbrev;\n    }).tickPadding(6);\n    let yAxis = d3.axisRight(y).tickFormat(d => {\n      return numberFormatFn(d);\n    }).ticks(6).tickPadding(6); // //////////////////////// Define the lines and/or areas  ////////////////////////\n    // put consts of the lines into the global scope\n    // defined means it can show gaps, isNan means it can have zero as a value\n\n    function createLineConsts() {\n      let myArr = [];\n      myArrayOfKeys.map((val, index) => {\n        console.log(val[\"dataKey\"]);\n        myArr.push(d3.line().defined(d => {\n          return !Number.isNaN(d[val[\"dataKey\"]]);\n        }).x((d, i) => {\n          return x(i);\n        }).y(d => y(d[val[\"dataKey\"]])));\n      });\n      return myArr;\n    }\n\n    const lineConst = createLineConsts();\n    console.log(lineConst); // // //////////////////////// Define parent SVG  ////////////////////////\n\n    const CVsvg = d3.select(containerElement).append(\"svg\").attr(\"class\", \"line-chart-svg-container\").attr(\"id\", myID).attr(\"width\", \"100%\").attr(\"height\", height + margin.top + margin.bottom + 40).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\"); // // // //////////////////////// Loop through / sort data  ////////////////////////\n\n    chartData.forEach(d => {\n      d = +d;\n    }); // // // //////////////////////// Set the domains  ////////////////////////\n\n    x.domain([parseInt(d3.min(chartData, (d, i) => i)), parseInt(d3.max(chartData, (d, i) => i))]);\n    y.domain([minVal, maxVal]); // y.domain([0, maxVal]);\n    // // // //////////////////////// Append the lines / areas  ////////////////////////\n\n    myArrayOfKeys.forEach((item, index) => {\n      console.log(item[\"color\"]);\n      CVsvg.append(\"path\").datum(chartData).attr(\"class\", \"line\").attr(\"stroke\", item[\"color\"]).attr(\"d\", lineConst[index]).transition().duration(1000);\n    }); // // // ///////////////////////  Add the X & Y Axis  ////////////////////////\n\n    CVsvg.append(\"g\").attr(\"class\", \"yAxis\").attr(\"transform\", \"translate(\" + (width + 6) + \",0)\").call(yAxis);\n    CVsvg.append(\"g\").attr(\"class\", \"xAxis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(xAxis); // // // //////////////////////// Add Line Tracing on mouse and markers   ////////////////////////\n\n    const lineTrace = CVsvg.append(\"line\").attr(\"class\", \"mouse-line x\").style(\"opacity\", 0.5).attr(\"y1\", 0).attr(\"y2\", height);\n\n    function createMarkers() {\n      myArrayOfKeys.forEach((item, index) => {\n        CVsvg.append(\"g\").attr(\"class\", \"marker\".concat(index)).append(\"circle\").attr(\"class\", \"line-marker\").attr(\"stroke\", item[\"marker\"]).transition().duration(500).attr(\"r\", 5);\n      });\n    }\n\n    createMarkers(); // // // //////////////////////// Tooltip  ////////////////////////\n\n    const tooltipDiv = d3.select(containerElement).append(\"div\").attr(\"class\", \"tooltipDiv\").attr(\"id\", \"\".concat(myID, \"Tooltip\"));\n    const dateContainer = tooltipDiv.append(\"div\").attr(\"class\", \"text-container\");\n    dateContainer.append(\"div\").attr(\"class\", \"label-style mr-1\").text(\"Date\");\n    const dateText = dateContainer.append(\"div\").attr(\"class\", \"value-text\");\n\n    function createLineDivTextConsts() {\n      let myArr = [];\n      myArrayOfKeys.map((val, index) => {\n        myArr.push(tooltipDiv.append(\"div\").attr(\"class\", \"text-container\"));\n      });\n      return myArr;\n    }\n\n    const lineTextContainer = createLineDivTextConsts();\n    myArrayOfKeys.forEach((item, index) => {\n      lineTextContainer[index].append(\"div\").attr(\"class\", \"label-style mr-1\").text(item[\"tooltipLabel\"]);\n      lineTextContainer[index].append(\"div\").attr(\"class\", \"dash\").style(\"background-color\", item[\"color\"]);\n    });\n\n    function createLineTextConsts() {\n      let myArr = [];\n      myArrayOfKeys.map((item, index) => {\n        myArr.push(lineTextContainer[index].append(\"div\").attr(\"class\", \"value-text\").attr(\"id\", \"lineTextConst\".concat(myID).concat(index)));\n      });\n      return myArr;\n    }\n\n    const lineTextConsts = createLineTextConsts(); // const YOYContainer = tooltipDiv\n    //   .append(\"div\")\n    //   .attr(\"class\", \"text-container\");\n    // YOYContainer.append(\"div\")\n    //   .attr(\"class\", \"label-style mr-1\")\n    //   .text(\"YOY\");\n    // const YOYText = YOYContainer.append(\"div\");\n    // // //////////////////////// Add Rect to Capture Mouse Movements  ////////////////////////\n\n    CVsvg.append(\"rect\").on(\"mouseover\", () => {\n      lineTrace.style(\"display\", null);\n      d3.select(\"#\".concat(myID, \" .mouse-line\")).style(\"opacity\", \"1\"); // d3.selectAll(\".mouse-per-line .line-marker\").style(\"opacity\", \"1\");\n    }).on(\"mousemove\", () => {\n      let xy = d3.mouse(d3.event.currentTarget);\n      let x0 = x.invert(xy[0]);\n      let mouseIndex = justBisect(chartData, x0, 1);\n      let d0 = chartData[mouseIndex - 1];\n      let d1 = chartData[mouseIndex];\n      let d;\n\n      if (d1 !== undefined) {\n        d = x0 - chartData.indexOf(d0) > chartData.indexOf(d1) - x0 ? d1 : d0;\n      } else {\n        d = d0;\n      }\n\n      lineTrace.attr(\"transform\", \"translate(\" + x(chartData.indexOf(d)) + \",0)\");\n      myArrayOfKeys.forEach((item, index) => {\n        d3.select(\"#\".concat(myID, \" .marker\").concat(index)).attr(\"transform\", \"translate(\" + x(chartData.indexOf(d)) + \",\" + y(d[item[\"dataKey\"]]) + \")\");\n      });\n      myArrayOfKeys.forEach((item, index) => {\n        let myText = d[myArrayOfKeys[index]] !== null ? numberFormatFn(d[item[\"dataKey\"]]) : \"\";\n        d3.select(\"#\".concat(myID, \"Tooltip #lineTextConst\").concat(myID).concat(index)).text(myText);\n      });\n      dateText.text(d.niceDate + \" \" + d.niceTime);\n      d3.select(\"#\".concat(myID, \" .mouse-line\")).attr(\"y2\", height);\n    }).on(\"mouseleave\", () => {\n      d3.select(\"#\".concat(myID, \" .mouse-line\")).style(\"opacity\", \".5\");\n    }).attr(\"class\", \"totalRect\").attr(\"fill\", \"none\").attr(\"x\", 0).attr(\"pointer-events\", \"all\").attr(\"width\", width).attr(\"transform\", \"translate(0,0)\").attr(\"height\", height).transition().duration(500); // ////////////////////////// Set the data on load ////////////////////////\n\n    d3.set().add(chartData[chartData.length - 1]);\n    let d = chartData[chartData.length - 1];\n    lineTrace.attr(\"transform\", \"translate(\" + x(chartData.indexOf(d)) + \",0)\");\n    myArrayOfKeys.forEach((item, index) => {\n      d3.select(\"#\".concat(myID, \" .marker\").concat(index)).attr(\"transform\", \"translate(\" + x(chartData.indexOf(d)) + \",\" + y(d[item[\"dataKey\"]]) + \")\");\n    });\n    myArrayOfKeys.forEach((item, index) => {\n      let myText = d[myArrayOfKeys[index]] !== null ? numberFormatFn(d[item[\"dataKey\"]]) : \"\";\n      d3.select(\"#\".concat(myID, \"Tooltip #lineTextConst\").concat(myID).concat(index)).text(myText);\n    });\n    dateText.text(d.niceDate + \" \" + d.niceTime); // // YOYText.text(YOYdiff);\n    // // YOYText.attr(\"class\", YOYdiffColor);\n\n    d3.select(\"#\".concat(myID, \" .mouse-line\")).attr(\"y2\", height);\n  }\n\n  useEffect(() => {\n    createChart(chartData, valueArray, props.myID, props.numberFormatFn);\n  }, []);\n  useEffect(() => {\n    createChart(chartData, valueArray, props.myID, props.numberFormatFn);\n  }, [props.resize]);\n  return React.createElement(\"div\", {\n    ref: chart,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359\n    },\n    __self: this\n  });\n}","map":{"version":3,"sources":["/Users/amandainnis/ReactProjects/react-site/portfolio/src/components/reusable/LineChart.js"],"names":["React","createRef","useState","useRef","useEffect","d3","moment","LineChart","props","chart","innerWidth","defaultHeight","containerElement","YOYdiff","data","chartData","setChartData","valueArray","setValueArray","getYOYdiffColor","YOY","prepMaxVal","myData","myArrayOfKeys","tempArr","tempStartVal","i","length","j","push","getMaxVal","tempArrB","tempMax","reduce","a","b","Math","max","tempMin","min","createChart","myID","numberFormatFn","current","clientWidth","console","log","innerHTML","tempMinMax","minVal","maxVal","margin","top","right","bottom","left","width","Number","isNaN","parseInt","select","style","height","justBisect","bisector","d","indexOf","x","scaleLinear","range","y","xAxis","axisBottom","ticks","tickFormat","niceDateAbbrev","tickPadding","yAxis","axisRight","createLineConsts","myArr","map","val","index","line","defined","lineConst","CVsvg","append","attr","forEach","domain","item","datum","transition","duration","call","lineTrace","createMarkers","tooltipDiv","dateContainer","text","dateText","createLineDivTextConsts","lineTextContainer","createLineTextConsts","lineTextConsts","on","xy","mouse","event","currentTarget","x0","invert","mouseIndex","d0","d1","undefined","myText","niceDate","niceTime","set","add","resize"],"mappings":"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","sourcesContent":["import React, { createRef, useState, useRef, useEffect } from \"react\";\nimport * as d3 from \"d3\";\n\nimport * as moment from \"moment\";\n\n// each charted value has a display name for tooltip\n// tooltip may or may not have a charted value\n// each line takes a\nexport default function LineChart(props) {\n  const chart = createRef();\n  let innerWidth;\n  const defaultHeight = 220;\n  var containerElement;\n  let YOYdiff;\n  const [chartData, setChartData] = useState(props.data);\n  // const [innerWidth, setInnerWidth] = useState();\n\n  const [valueArray, setValueArray] = useState(props.valueArray);\n\n  // function getLineDiffValue(line0, lineTwo) {\n  //   return line0 == null || lineTwo == null ? null : line0 - lineTwo;\n  // }\n  function getYOYdiffColor(YOY) {\n    if (YOY < 0) {\n      return \"YOYred\";\n    } else {\n      return \"YOYgreen\";\n    }\n  }\n  function prepMaxVal(myData, myArrayOfKeys) {\n    let tempArr = [];\n    let tempStartVal = [];\n    for (let i = 0; i < myData.length; i++) {\n      // push whatever arr[j] is in the array as a key into\n      for (let j = 0; j < myArrayOfKeys.length; j++) {\n        if (myData[i][myArrayOfKeys[j]] !== null) {\n          tempArr.push(myData[i][myArrayOfKeys[j][\"dataKey\"]]);\n        }\n      }\n    }\n    return tempArr;\n  }\n\n  function getMaxVal(myData, myArrayOfKeys) {\n    // console.log(startVals, startValsRef);\n    let tempArr = prepMaxVal(myData, myArrayOfKeys);\n    let tempArrB = prepMaxVal(myData, myArrayOfKeys);\n\n    let tempMax = tempArr.reduce((a, b) => Math.max(a, b));\n    let tempMin = tempArrB.reduce((a, b) => Math.min(a, b));\n    return { min: tempMin, max: tempMax };\n  }\n\n  function createChart(chartData, myArrayOfKeys, myID, numberFormatFn) {\n    containerElement = chart.current;\n    innerWidth = chart.current.clientWidth;\n    console.log(innerWidth);\n    containerElement.innerHTML = \"\";\n    let tempMinMax = getMaxVal(chartData, myArrayOfKeys);\n    let minVal = tempMinMax.min;\n    let maxVal = tempMinMax.max;\n    // let currentMonth = getCurrentMonth();\n    let margin = { top: 20, right: 60, bottom: 0, left: 10 };\n    //////////////////////// Establish the reused vals and the bound functions  ////////////////////////\n    let width = Number.isNaN(\n      parseInt(d3.select(containerElement).style(\"width\"))\n    )\n      ? 0\n      : parseInt(d3.select(containerElement).style(\"width\")) -\n        margin.left -\n        margin.right;\n    let height = 300 - margin.top;\n    let justBisect = d3.bisector(d => chartData.indexOf(d)).left;\n\n    //////////////////////// Set the scales  ////////////////////////\n\n    let x = d3.scaleLinear().range([0, width]);\n    let y = d3.scaleLinear().range([height, 0]);\n\n    // //////////////////////// Set the axis ////////////////////////\n\n    let xAxis = d3\n      .axisBottom(x)\n      .ticks(innerWidth => {\n        if (innerWidth < 450) {\n          return 4;\n        }\n      })\n      .tickFormat(function(d) {\n        return chartData[d].niceDateAbbrev;\n      })\n      .tickPadding(6);\n\n    let yAxis = d3\n      .axisRight(y)\n      .tickFormat(d => {\n        return numberFormatFn(d);\n      })\n      .ticks(6)\n      .tickPadding(6);\n\n    // //////////////////////// Define the lines and/or areas  ////////////////////////\n\n    // put consts of the lines into the global scope\n    // defined means it can show gaps, isNan means it can have zero as a value\n    function createLineConsts() {\n      let myArr = [];\n      myArrayOfKeys.map((val, index) => {\n        console.log(val[\"dataKey\"]);\n        myArr.push(\n          d3\n            .line()\n            .defined(d => {\n              return !Number.isNaN(d[val[\"dataKey\"]]);\n            })\n            .x((d, i) => {\n              return x(i);\n            })\n            .y(d => y(d[val[\"dataKey\"]]))\n        );\n      });\n      return myArr;\n    }\n\n    const lineConst = createLineConsts();\n    console.log(lineConst);\n    // // //////////////////////// Define parent SVG  ////////////////////////\n\n    const CVsvg = d3\n      .select(containerElement)\n      .append(\"svg\")\n      .attr(\"class\", \"line-chart-svg-container\")\n      .attr(\"id\", myID)\n      .attr(\"width\", \"100%\")\n      .attr(\"height\", height + margin.top + margin.bottom + 40)\n      .append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    // // // //////////////////////// Loop through / sort data  ////////////////////////\n\n    chartData.forEach(d => {\n      d = +d;\n    });\n\n    // // // //////////////////////// Set the domains  ////////////////////////\n\n    x.domain([\n      parseInt(d3.min(chartData, (d, i) => i)),\n      parseInt(d3.max(chartData, (d, i) => i))\n    ]);\n    y.domain([minVal, maxVal]);\n    // y.domain([0, maxVal]);\n\n    // // // //////////////////////// Append the lines / areas  ////////////////////////\n\n    myArrayOfKeys.forEach((item, index) => {\n      console.log(item[\"color\"]);\n      CVsvg.append(\"path\")\n        .datum(chartData)\n        .attr(\"class\", \"line\")\n        .attr(\"stroke\", item[\"color\"])\n        .attr(\"d\", lineConst[index])\n        .transition()\n        .duration(1000);\n    });\n\n    // // // ///////////////////////  Add the X & Y Axis  ////////////////////////\n\n    CVsvg.append(\"g\")\n      .attr(\"class\", \"yAxis\")\n      .attr(\"transform\", \"translate(\" + (width + 6) + \",0)\")\n      .call(yAxis);\n\n    CVsvg.append(\"g\")\n      .attr(\"class\", \"xAxis\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(xAxis);\n\n    // // // //////////////////////// Add Line Tracing on mouse and markers   ////////////////////////\n\n    const lineTrace = CVsvg.append(\"line\")\n      .attr(\"class\", \"mouse-line x\")\n      .style(\"opacity\", 0.5)\n      .attr(\"y1\", 0)\n      .attr(\"y2\", height);\n\n    function createMarkers() {\n      myArrayOfKeys.forEach((item, index) => {\n        CVsvg.append(\"g\")\n          .attr(\"class\", `marker${index}`)\n          .append(\"circle\")\n          .attr(\"class\", `line-marker`)\n          .attr(\"stroke\", item[\"marker\"])\n          .transition()\n          .duration(500)\n          .attr(\"r\", 5);\n      });\n    }\n\n    createMarkers();\n    // // // //////////////////////// Tooltip  ////////////////////////\n\n    const tooltipDiv = d3\n      .select(containerElement)\n      .append(\"div\")\n      .attr(\"class\", \"tooltipDiv\")\n      .attr(\"id\", `${myID}Tooltip`);\n    const dateContainer = tooltipDiv\n      .append(\"div\")\n      .attr(\"class\", \"text-container\");\n    dateContainer\n      .append(\"div\")\n      .attr(\"class\", \"label-style mr-1\")\n      .text(\"Date\");\n    const dateText = dateContainer.append(\"div\").attr(\"class\", \"value-text\");\n\n    function createLineDivTextConsts() {\n      let myArr = [];\n      myArrayOfKeys.map((val, index) => {\n        myArr.push(tooltipDiv.append(\"div\").attr(\"class\", \"text-container\"));\n      });\n      return myArr;\n    }\n    const lineTextContainer = createLineDivTextConsts();\n\n    myArrayOfKeys.forEach((item, index) => {\n      lineTextContainer[index]\n        .append(\"div\")\n        .attr(\"class\", \"label-style mr-1\")\n        .text(item[\"tooltipLabel\"]);\n\n      lineTextContainer[index]\n        .append(\"div\")\n        .attr(\"class\", \"dash\")\n        .style(\"background-color\", item[\"color\"]);\n    });\n\n    function createLineTextConsts() {\n      let myArr = [];\n      myArrayOfKeys.map((item, index) => {\n        myArr.push(\n          lineTextContainer[index]\n            .append(\"div\")\n            .attr(\"class\", `value-text`)\n            .attr(\"id\", `lineTextConst${myID}${index}`)\n        );\n      });\n      return myArr;\n    }\n    const lineTextConsts = createLineTextConsts();\n    // const YOYContainer = tooltipDiv\n    //   .append(\"div\")\n    //   .attr(\"class\", \"text-container\");\n    // YOYContainer.append(\"div\")\n    //   .attr(\"class\", \"label-style mr-1\")\n    //   .text(\"YOY\");\n    // const YOYText = YOYContainer.append(\"div\");\n\n    // // //////////////////////// Add Rect to Capture Mouse Movements  ////////////////////////\n\n    CVsvg.append(\"rect\")\n      .on(\"mouseover\", () => {\n        lineTrace.style(\"display\", null);\n        d3.select(`#${myID} .mouse-line`).style(\"opacity\", \"1\");\n        // d3.selectAll(\".mouse-per-line .line-marker\").style(\"opacity\", \"1\");\n      })\n      .on(\"mousemove\", () => {\n        let xy = d3.mouse(d3.event.currentTarget);\n\n        let x0 = x.invert(xy[0]);\n        let mouseIndex = justBisect(chartData, x0, 1);\n        let d0 = chartData[mouseIndex - 1];\n        let d1 = chartData[mouseIndex];\n        let d;\n        if (d1 !== undefined) {\n          d = x0 - chartData.indexOf(d0) > chartData.indexOf(d1) - x0 ? d1 : d0;\n        } else {\n          d = d0;\n        }\n\n        lineTrace.attr(\n          \"transform\",\n          \"translate(\" + x(chartData.indexOf(d)) + \",0)\"\n        );\n        myArrayOfKeys.forEach((item, index) => {\n          d3.select(`#${myID} .marker${index}`).attr(\n            \"transform\",\n            \"translate(\" +\n              x(chartData.indexOf(d)) +\n              \",\" +\n              y(d[item[\"dataKey\"]]) +\n              \")\"\n          );\n        });\n        myArrayOfKeys.forEach((item, index) => {\n          let myText =\n            d[myArrayOfKeys[index]] !== null\n              ? numberFormatFn(d[item[\"dataKey\"]])\n              : \"\";\n\n          d3.select(`#${myID}Tooltip #lineTextConst${myID}${index}`).text(\n            myText\n          );\n        });\n\n        dateText.text(d.niceDate + \" \" + d.niceTime);\n\n        d3.select(`#${myID} .mouse-line`).attr(\"y2\", height);\n      })\n      .on(\"mouseleave\", () => {\n        d3.select(`#${myID} .mouse-line`).style(\"opacity\", \".5\");\n      })\n      .attr(\"class\", \"totalRect\")\n      .attr(\"fill\", \"none\")\n      .attr(\"x\", 0)\n      .attr(\"pointer-events\", \"all\")\n      .attr(\"width\", width)\n      .attr(\"transform\", \"translate(0,0)\")\n      .attr(\"height\", height)\n      .transition()\n      .duration(500);\n\n    // ////////////////////////// Set the data on load ////////////////////////\n\n    d3.set().add(chartData[chartData.length - 1]);\n    let d = chartData[chartData.length - 1];\n    lineTrace.attr(\"transform\", \"translate(\" + x(chartData.indexOf(d)) + \",0)\");\n    myArrayOfKeys.forEach((item, index) => {\n      d3.select(`#${myID} .marker${index}`).attr(\n        \"transform\",\n        \"translate(\" +\n          x(chartData.indexOf(d)) +\n          \",\" +\n          y(d[item[\"dataKey\"]]) +\n          \")\"\n      );\n    });\n    myArrayOfKeys.forEach((item, index) => {\n      let myText =\n        d[myArrayOfKeys[index]] !== null\n          ? numberFormatFn(d[item[\"dataKey\"]])\n          : \"\";\n\n      d3.select(`#${myID}Tooltip #lineTextConst${myID}${index}`).text(myText);\n    });\n    dateText.text(d.niceDate + \" \" + d.niceTime);\n    // // YOYText.text(YOYdiff);\n    // // YOYText.attr(\"class\", YOYdiffColor);\n\n    d3.select(`#${myID} .mouse-line`).attr(\"y2\", height);\n  }\n\n  useEffect(() => {\n    createChart(chartData, valueArray, props.myID, props.numberFormatFn);\n  }, []);\n  useEffect(() => {\n    createChart(chartData, valueArray, props.myID, props.numberFormatFn);\n  }, [props.resize]);\n  return <div ref={chart}></div>;\n}\n"]},"metadata":{},"sourceType":"module"}