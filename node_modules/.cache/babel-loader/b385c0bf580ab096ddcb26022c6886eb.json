{"ast":null,"code":"var _jsxFileName = \"/Users/amandainnis/ReactProjects/board-app/src/components/crb/CRBCard.js\";\nimport React from \"react\";\nimport IsLoading from \"../reusable/IsLoading\";\nimport * as Common from \"../reusable/common\";\nimport StockData from \"../../data/stock_data\";\n\nconst imgCRB = require(\"../../assets/images/crb-img.png\");\n\nconst data = {\n  id: 3,\n  img: imgCRB,\n  title: \"CRB Pricer\",\n  subtitle: \"Central Risk Book Pricing and Trade Execution\",\n  blurb: [\"\"],\n  bkgd: \"var(--crb-bkgd)\"\n};\nconst allTickers = StockData.slice();\n\nclass CRBCard extends React.Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n\n    this.getTickerURL = ticker => \"https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=\".concat(ticker, \"&interval=5min&outputsize=full&apikey=NKT90SOYWKFBP04F\");\n\n    this.tickerInputRef = React.createRef();\n    this.ddRef = React.createRef();\n    this.state = {\n      // tickerInputRef: this.tickerInputRef,\n      price: 0,\n      tickerCompany: \"Amazon.com\",\n      tickerInput: \"AMZN\",\n      selectedTicker: null,\n      isLoading: true,\n      tickerDDVisible: false,\n      tickerDDReservoir: StockData,\n      tickerDDFiltered: null // ddListIndex: 0\n\n    };\n    this.handleKeyUp = this.handleKeyUp.bind(this);\n    this.handleDDClick = this.handleDDClick.bind(this); // O_ZSRWosEBhztl68tl2vPw  us funda\n  }\n\n  fetchTicker(ticker) {\n    return fetch(this.getTickerURL(ticker)).then(res => {\n      // console.log(res);\n      if (!res.ok) {\n        throw Error(\"sadface, the res doesnt want to be our friend, but dont feel bad.  btw im middleware\");\n      } // console.log(res);\n\n\n      return res;\n    }).then(res => // this is the promise so don't have a return statement, it will be if and when  its ready\n    // better with es6\n    // console.log(res.json())\n    res.json()); // .then(res => enzo = res);\n  }\n\n  resolveFetchedTicker(ticker, loadingBool) {\n    this.setState({\n      isLoading: true\n    });\n    this.fetchTicker(ticker).then(res => {\n      let myKeys;\n\n      if (loadingBool) {\n        if (res !== undefined && res[\"Time Series (5min)\"] !== undefined) {\n          myKeys = Object.keys(res[\"Time Series (5min)\"]);\n          this.setState({\n            isLoading: false,\n            // ticker: ticker,\n            price: res[\"Time Series (5min)\"][myKeys[0]][\"1. open\"]\n          });\n        } else {\n          this.setState({\n            isLoading: false,\n            ticker: \"Not a Ticker\",\n            price: null\n          });\n        }\n      }\n    });\n  }\n\n  handleTickerInput(e) {\n    const tickerDDList = allTickers.slice();\n    let myResults;\n\n    if (e !== null || e !== \"\") {\n      myResults = tickerDDList.filter(function (myKey) {\n        return myKey.symbol.startsWith(e.target.value.toUpperCase());\n      }); // console.log(myResults);\n\n      this.setState({\n        tickerInput: e.target.value,\n        tickerDDFiltered: myResults\n      }); // this.ddRef.current.childNodes[0].focus();\n      // console.log(this.ddRef.current);\n    }\n  }\n\n  getPrice() {\n    const myTicker = this.state.tickerInput; // this.setState({ ticker: myTicker });\n\n    console.log(myTicker);\n    this.resolveFetchedTicker(myTicker, true);\n  }\n\n  eraseInput() {\n    console.log(this.tickerInputRef);\n    this.tickerInputRef.current.focus();\n    this.setState({\n      tickerInput: \"\",\n      tickerCompany: \"\",\n      price: \"\"\n    });\n  }\n\n  handleKeyUp(e) {\n    console.log(e.which);\n    this.setState({\n      tickerDDVisible: true\n    }); // if (e.which === 40) {\n    //   this.ddRef.current.children[this.state.ddListIndex].focus();\n    // }\n  }\n\n  handleDDClick(val, name) {\n    console.log(val);\n    this.setState({\n      tickerInput: val.symbol,\n      tickerCompany: val.name,\n      tickerDDVisible: false\n    });\n  }\n\n  handleArrowEvents(e) {\n    console.log(e, e.which);\n\n    if (e.which === 40) {\n      console.log(this.state, this.ddRef); // this.ddRef.current.children[0].focus();\n      // this.ddRef.current.children[this.state.ddListIndex].focus();\n    } //       console.log(this.ddRef);\n    //   this.setState(prevState => {\n    //     return { ddListIndex: prevState + 1 };\n    //   });\n\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.resolveFetchedTicker(\"AMZN\", this._isMounted);\n    console.log(this.state); // the below was so i could capture the arrow on the dropdown\n\n    window.addEventListener(\"keyup\", this.handleArrowEvents.bind(this));\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  render() {\n    let price = Math.round(this.state.price * 100) / 100;\n    price = this.state.price !== \"\" ? \"$\" + price : \"\";\n    const tickerCompany = this.state.tickerCompany; // this is a promise\n\n    return React.createElement(\"article\", {\n      className: \"portfolio-card\",\n      style: {\n        backgroundColor: data.bkgd\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(IsLoading, {\n      isLoading: this.state.isLoading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"text-section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, data.title), React.createElement(\"h4\", {\n      className: \"subtitle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, data.subtitle)), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"flex-row mt-3 crb-title-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"ticker-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, tickerCompany), React.createElement(\"div\", {\n      className: \"price-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, price)), React.createElement(\"div\", {\n      className: \"input-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"relative\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"clearable\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      ref: this.tickerInputRef,\n      className: \"input-style crb-input\",\n      type: \"text\",\n      placeholder: \"ticker\",\n      name: \"tickerInput\",\n      autoComplete: \"off\",\n      value: this.state.tickerInput,\n      onChange: e => {\n        this.handleTickerInput(e);\n      },\n      onKeyUp: e => {\n        this.handleKeyUp(e);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }), this.state.tickerInput !== \"\" ? React.createElement(\"span\", {\n      className: \"clearable-clear mdi mdi-close\",\n      onClick: () => {\n        this.eraseInput();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }) : null, this.state.tickerDDVisible && React.createElement(\"div\", {\n      className: \"dropdown-container crb\",\n      ref: this.ddRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, this.state.tickerDDFiltered !== \"\" && this.state.tickerDDFiltered.map((val, i) => {\n      return React.createElement(\"button\", {\n        key: i,\n        onClick: e => {\n          this.handleDDClick(val, \"tickerInput\");\n        },\n        value: this.state.selectedTicker,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, val.symbol, \" - \", val.name);\n    }))))), React.createElement(\"button\", {\n      onClick: () => {\n        this.getPrice();\n      },\n      className: \"var(--crb-button-type) large green mt-3 crb-button\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    }, \"price\")));\n  }\n\n}\n\nexport default CRBCard;","map":{"version":3,"sources":["/Users/amandainnis/ReactProjects/board-app/src/components/crb/CRBCard.js"],"names":["React","IsLoading","Common","StockData","imgCRB","require","data","id","img","title","subtitle","blurb","bkgd","allTickers","slice","CRBCard","Component","constructor","props","_isMounted","getTickerURL","ticker","tickerInputRef","createRef","ddRef","state","price","tickerCompany","tickerInput","selectedTicker","isLoading","tickerDDVisible","tickerDDReservoir","tickerDDFiltered","handleKeyUp","bind","handleDDClick","fetchTicker","fetch","then","res","ok","Error","json","resolveFetchedTicker","loadingBool","setState","myKeys","undefined","Object","keys","handleTickerInput","e","tickerDDList","myResults","filter","myKey","symbol","startsWith","target","value","toUpperCase","getPrice","myTicker","console","log","eraseInput","current","focus","which","val","name","handleArrowEvents","componentDidMount","window","addEventListener","componentWillUnmount","render","Math","round","backgroundColor","map","i"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport IsLoading from \"../reusable/IsLoading\";\nimport * as Common from \"../reusable/common\";\nimport StockData from \"../../data/stock_data\";\nconst imgCRB = require(\"../../assets/images/crb-img.png\");\nconst data = {\n  id: 3,\n  img: imgCRB,\n  title: \"CRB Pricer\",\n  subtitle: \"Central Risk Book Pricing and Trade Execution\",\n  blurb: [\"\"],\n  bkgd: \"var(--crb-bkgd)\"\n};\n\nconst allTickers = StockData.slice();\nclass CRBCard extends React.Component {\n  _isMounted = false;\n\n  constructor(props) {\n    super(props);\n    this.tickerInputRef = React.createRef();\n    this.ddRef = React.createRef();\n\n    this.state = {\n      // tickerInputRef: this.tickerInputRef,\n      price: 0,\n      tickerCompany: \"Amazon.com\",\n      tickerInput: \"AMZN\",\n      selectedTicker: null,\n      isLoading: true,\n      tickerDDVisible: false,\n      tickerDDReservoir: StockData,\n      tickerDDFiltered: null\n      // ddListIndex: 0\n    };\n    this.handleKeyUp = this.handleKeyUp.bind(this);\n    this.handleDDClick = this.handleDDClick.bind(this);\n\n    // O_ZSRWosEBhztl68tl2vPw  us funda\n  }\n  getTickerURL = ticker =>\n    `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${ticker}&interval=5min&outputsize=full&apikey=NKT90SOYWKFBP04F`;\n\n  fetchTicker(ticker) {\n    return fetch(this.getTickerURL(ticker))\n      .then(res => {\n        // console.log(res);\n        if (!res.ok) {\n          throw Error(\n            \"sadface, the res doesnt want to be our friend, but dont feel bad.  btw im middleware\"\n          );\n        }\n        // console.log(res);\n        return res;\n      })\n      .then(res =>\n        // this is the promise so don't have a return statement, it will be if and when  its ready\n        // better with es6\n        // console.log(res.json())\n        res.json()\n      );\n    // .then(res => enzo = res);\n  }\n  resolveFetchedTicker(ticker, loadingBool) {\n    this.setState({\n      isLoading: true\n    });\n    this.fetchTicker(ticker).then(res => {\n      let myKeys;\n      if (loadingBool) {\n        if (res !== undefined && res[\"Time Series (5min)\"] !== undefined) {\n          myKeys = Object.keys(res[\"Time Series (5min)\"]);\n          this.setState({\n            isLoading: false,\n            // ticker: ticker,\n            price: res[\"Time Series (5min)\"][myKeys[0]][\"1. open\"]\n          });\n        } else {\n          this.setState({\n            isLoading: false,\n            ticker: \"Not a Ticker\",\n            price: null\n          });\n        }\n      }\n    });\n  }\n\n  handleTickerInput(e) {\n    const tickerDDList = allTickers.slice();\n    let myResults;\n\n    if (e !== null || e !== \"\") {\n      myResults = tickerDDList.filter(function(myKey) {\n        return myKey.symbol.startsWith(e.target.value.toUpperCase());\n      });\n      // console.log(myResults);\n      this.setState({\n        tickerInput: e.target.value,\n        tickerDDFiltered: myResults\n      });\n      // this.ddRef.current.childNodes[0].focus();\n      // console.log(this.ddRef.current);\n    }\n  }\n  getPrice() {\n    const myTicker = this.state.tickerInput;\n    // this.setState({ ticker: myTicker });\n    console.log(myTicker);\n    this.resolveFetchedTicker(myTicker, true);\n  }\n  eraseInput() {\n    console.log(this.tickerInputRef);\n    this.tickerInputRef.current.focus();\n    this.setState({\n      tickerInput: \"\",\n      tickerCompany: \"\",\n      price: \"\"\n    });\n  }\n  handleKeyUp(e) {\n    console.log(e.which);\n    this.setState({\n      tickerDDVisible: true\n    });\n    // if (e.which === 40) {\n    //   this.ddRef.current.children[this.state.ddListIndex].focus();\n    // }\n  }\n  handleDDClick(val, name) {\n    console.log(val);\n    this.setState({\n      tickerInput: val.symbol,\n      tickerCompany: val.name,\n      tickerDDVisible: false\n    });\n  }\n  handleArrowEvents(e) {\n    console.log(e, e.which);\n\n    if (e.which === 40) {\n      console.log(this.state, this.ddRef);\n      // this.ddRef.current.children[0].focus();\n      // this.ddRef.current.children[this.state.ddListIndex].focus();\n    }\n    //       console.log(this.ddRef);\n    //   this.setState(prevState => {\n    //     return { ddListIndex: prevState + 1 };\n    //   });\n  }\n  componentDidMount() {\n    this._isMounted = true;\n    this.resolveFetchedTicker(\"AMZN\", this._isMounted);\n    console.log(this.state);\n    // the below was so i could capture the arrow on the dropdown\n    window.addEventListener(\"keyup\", this.handleArrowEvents.bind(this));\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n  render() {\n    let price = Math.round(this.state.price * 100) / 100;\n    price = this.state.price !== \"\" ? \"$\" + price : \"\";\n    const tickerCompany = this.state.tickerCompany;\n    // this is a promise\n\n    return (\n      <article\n        className=\"portfolio-card\"\n        style={{ backgroundColor: data.bkgd }}\n      >\n        <IsLoading isLoading={this.state.isLoading}></IsLoading>\n        <div className=\"text-section\">\n          <h1 className=\"title\">{data.title}</h1>\n          <h4 className=\"subtitle\">{data.subtitle}</h4>\n        </div>\n        <div>\n          <div className=\"flex-row mt-3 crb-title-row\">\n            <div className=\"ticker-title\">{tickerCompany}</div>\n            <div className=\"price-title\">{price}</div>\n          </div>\n\n          <div className=\"input-group\">\n            <div className=\"relative\">\n              <div className=\"clearable\">\n                <input\n                  ref={this.tickerInputRef}\n                  className=\"input-style crb-input\"\n                  type=\"text\"\n                  placeholder=\"ticker\"\n                  name=\"tickerInput\"\n                  autoComplete=\"off\"\n                  value={this.state.tickerInput}\n                  onChange={e => {\n                    this.handleTickerInput(e);\n                  }}\n                  onKeyUp={e => {\n                    this.handleKeyUp(e);\n                  }}\n                />\n\n                {this.state.tickerInput !== \"\" ? (\n                  <span\n                    className=\"clearable-clear mdi mdi-close\"\n                    onClick={() => {\n                      this.eraseInput();\n                    }}\n                  ></span>\n                ) : null}\n                {this.state.tickerDDVisible && (\n                  <div className=\"dropdown-container crb\" ref={this.ddRef}>\n                    {this.state.tickerDDFiltered !== \"\" &&\n                      this.state.tickerDDFiltered.map((val, i) => {\n                        return (\n                          <button\n                            key={i}\n                            onClick={e => {\n                              this.handleDDClick(val, \"tickerInput\");\n                            }}\n                            value={this.state.selectedTicker}\n                          >\n                            {val.symbol} - {val.name}\n                          </button>\n                        );\n                      })}\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n          <button\n            onClick={() => {\n              this.getPrice();\n            }}\n            className=\"var(--crb-button-type) large green mt-3 crb-button\"\n          >\n            price\n          </button>\n        </div>\n      </article>\n    );\n  }\n}\n\nexport default CRBCard;\n"]},"metadata":{},"sourceType":"module"}