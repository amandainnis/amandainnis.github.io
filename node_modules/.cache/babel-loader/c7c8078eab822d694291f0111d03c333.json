{"ast":null,"code":"import _slicedToArray from\"/Users/amandainnis/amandainnis.github.io/amandainnis.github.io/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{createRef,useState,useRef,useEffect}from\"react\";import*as d3 from\"d3\";export default function LineChartCV(){var lineChartData=[{y2018:36,y2019:56,month:1},{y2018:47,y2019:99,month:2},{y2018:80,y2019:105,month:3},{y2018:90,y2019:115,month:4},{y2018:120,y2019:135,month:5}];var chart=createRef();var chartContainer=createRef();var maxVal=useRef();var defaultHeight=220;var containerElement;var _useState=useState(lineChartData),_useState2=_slicedToArray(_useState,2),chartData=_useState2[0],setChartData=_useState2[1];// this is where you want the selected bar group to start onInit--tooltip and highlight would start here\n// in most cases, we are starting with the current month\n// @Input(\"barIndexSetpoint\") barIndexSetpoint;\n// this is the function to format time values of x axis\n// @Input(\"timeFormatFn\") timeFormatFn;\n// constructor() {\n//   this.subs.sink = fromEvent(window, \"resize\").pipe(debounceTime(200)).subscribe(() => this.createChart());\n// }\nfunction numberFormatFn(d){return d;}function timeFormat(d){if(d==1){return\"Jan\";}else if(d==2){return\"Feb\";}else if(d==3){return\"Mar\";}else if(d==4){return\"Apr\";}else if(d==5){return\"May\";}else if(d==6){return\"Jun\";}else if(d==7){return\"Jul\";}else if(d==8){return\"Aug\";}else if(d==9){return\"Sep\";}else if(d==10){return\"Oct\";}else if(d==11){return\"Nov\";}else{return\"\";}}function getCurrentMonth(){var date=new Date();var currentMonthNumber=date.getMonth()+1;//console.log('i am current month number', currentMonthNumber);\nreturn currentMonthNumber;}function findlastValidDataCurrentYear(currVal,nextVal,currentObj,lastValid,dataArraySetPoint){if(nextVal==null&&currVal!==null){lastValid=currentObj;// console.log('nextVal == null && currVal !== null, i am currentObj', nextVal, currVal, currentObj)\nreturn lastValid;}else if(nextVal==null&&currVal==null&&lastValid==undefined){// console.log('nextVal == null && currVal == null && lastValid == undefined', nextVal, currVal, lastValid);\nlastValid=dataArraySetPoint;//console.log('i am now defined', lastValid);\nreturn lastValid;}else{// console.log('lastValid, nextVal, currVal, currentObj', lastValid, nextVal, currVal, currentObj)\nlastValid=lastValid;return lastValid;}}function getLineDiffValue(currYear,prevYear){return currYear==null||prevYear==null?null:currYear-prevYear;}function getYOYdiffColor(YOY){if(YOY<0){return\"YOYred\";}else{return\"YOYgreen\";}}// Math.min will assign null values to 0 so need to filter out null if want min to be actual min,\n// but it may look better to have an actual zero\nfunction getMaxVal(myData,yLineOne,yLineTwo){var tempArr=[];for(var i=0;i<myData.length;i++){tempArr.push(myData[i][yLineOne],myData[i][yLineTwo]);if(myData[i][yLineOne]!==null)tempArr.push(myData[i][yLineOne]);if(myData[i][yLineTwo]!==null)tempArr.push(myData[i][yLineTwo]);}var temp2018max=tempArr.reduce(function(a,b){return Math.max(a,b);});var temp2018min=tempArr.reduce(function(a,b){return Math.min(a,b);});return{min:temp2018min,max:temp2018max};}function createChart(chartData,yLineOne,yLineTwo,numberFormatFn,xAxisKeyName){var lastValidDataCurrentYear;//let lastValidDataPreviousYear;\nvar YOYdiff;containerElement=chart.current;containerElement.innerHTML=\"\";var tempMinMax=getMaxVal(chartData,yLineOne,yLineTwo);var minVal=tempMinMax.min;var maxVal=tempMinMax.max;var currentMonth=getCurrentMonth();var margin={top:20,right:60,bottom:0,left:10};//////////////////////// Establish the reused vals and the bound functions  ////////////////////////\nvar width=Number.isNaN(parseInt(d3.select(containerElement).style(\"width\")))?0:parseInt(d3.select(containerElement).style(\"width\"))-margin.left-margin.right;var height=220-margin.top;// translates a function to d3, passes angular scope into d3\n// tell format func that the function with \"this\" should be asscoiated with the currect ts component\n//let bisectDate = d3.bisector((d) => timeFormat(d[xAxisKeyName])).left; // this would return the month, but we aren't using it right now\nvar justBisect=d3.bisector(function(d){return d[xAxisKeyName];}).left;//////////////////////// Set the scales  ////////////////////////\nvar x=d3.scaleLinear().range([0,width]);var y=d3.scaleLinear().range([height,0]);//////////////////////// Set the axis ////////////////////////\nvar xAxis=d3.axisBottom(x).ticks(chartData.length).tickFormat(function(d){// console.log(d);\nreturn timeFormat(d);}).tickPadding(6);var yAxis=d3.axisRight(y).tickFormat(function(d){return numberFormatFn(d);})// .ticks(6)\n.tickPadding(6);//////////////////////// Define the lines and/or areas  ////////////////////////\nvar lineOne=d3.line().defined(function(d){if(d[yLineOne]!==null){return d[yLineOne];}}).x(function(d){return x(d[xAxisKeyName]);}).y(function(d){return y(d[yLineOne]);});var lineTwo=d3.line().defined(function(d){if(d[yLineTwo]!==null){return d[yLineTwo];}}).x(function(d){return x(d[xAxisKeyName]);}).y(function(d){return y(d[yLineTwo]);});//////////////////////// Define parent SVG  ////////////////////////\nvar CVsvg=d3.select(containerElement).append(\"svg\").attr(\"width\",\"100%\").attr(\"height\",height+margin.top+margin.bottom+40).append(\"g\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");//////////////////////// Loop through / sort data  ////////////////////////\nchartData.forEach(function(d){d=+d;});chartData.sort(function(a,b){return a[xAxisKeyName]-b[xAxisKeyName];});//////////////////////// Set the domains  ////////////////////////\nx.domain([parseInt(d3.min(chartData,function(d){return d[xAxisKeyName];})),parseInt(d3.max(chartData,function(d){return d[xAxisKeyName];}))]);y.domain([minVal,maxVal]);//////////////////////// Append the lines / areas  ////////////////////////\nCVsvg.append(\"path\").datum(chartData).attr(\"class\",\"lineOne line\").attr(\"d\",lineOne).transition().duration(500);CVsvg.append(\"path\").datum(chartData).attr(\"class\",\"lineTwo line\").attr(\"d\",lineTwo).transition().duration(500);///////////////////////  Add the X & Y Axis  ////////////////////////\nCVsvg.append(\"g\").attr(\"class\",\"yAxis\").attr(\"transform\",\"translate(\"+(width+6)+\",0)\").call(yAxis);CVsvg.append(\"g\").attr(\"class\",\"xAxis\").attr(\"transform\",\"translate(0,\"+height+\")\").call(xAxis);//////////////////////// Add Line Tracing on mouse and markers   ////////////////////////\nvar lineTrace=CVsvg.append(\"line\").attr(\"class\",\"mouse-line x\").style(\"opacity\",0.5).attr(\"y1\",0).attr(\"y2\",height);var marker=CVsvg.append(\"g\").attr(\"class\",\"marker\");marker.append(\"circle\").attr(\"class\",\"line-marker lineOne\").transition().duration(500).attr(\"r\",5);var marker2=CVsvg.append(\"g\").attr(\"class\",\"marker\");marker2.append(\"circle\").attr(\"class\",\"line-marker lineTwo\").transition().duration(500).attr(\"r\",5);//////////////////////// Tooltip  ////////////////////////\nvar tooltipDiv=d3.select(containerElement).append(\"div\").attr(\"class\",\"tooltipDiv\");var dateContainer=tooltipDiv.append(\"div\").attr(\"class\",\"text-container\");dateContainer.append(\"div\").attr(\"class\",\"label-style mr-1\").text(\"Month\");var dateText=dateContainer.append(\"div\").attr(\"class\",\"value-text\");var lineOneTextContainer=tooltipDiv.append(\"div\").attr(\"class\",\"text-container\");lineOneTextContainer.append(\"div\").attr(\"class\",\"label-style mr-1\").text(\"2018\");lineOneTextContainer.append(\"div\").attr(\"class\",\"dot lineOne\");var lineOneText=lineOneTextContainer.append(\"div\").attr(\"class\",\"value-text\");var lineTwoTextContainer=tooltipDiv.append(\"div\").attr(\"class\",\"text-container\");lineTwoTextContainer.append(\"div\").attr(\"class\",\"label-style mr-1\").text(\"2019\");lineTwoTextContainer.append(\"div\").attr(\"class\",\"dot lineTwo\");var lineTwoText=lineTwoTextContainer.append(\"div\").attr(\"class\",\"value-text\");var YOYContainer=tooltipDiv.append(\"div\").attr(\"class\",\"text-container\");YOYContainer.append(\"div\").attr(\"class\",\"label-style mr-1\").text(\"YOY\");var YOYText=YOYContainer.append(\"div\");//////////////////////// Add Rect to Capture Mouse Movements  ////////////////////////\nCVsvg.append(\"rect\").on(\"mouseover\",function(){lineTrace.style(\"display\",null);d3.select(\".mouse-line\").style(\"opacity\",\"1\");d3.selectAll(\".mouse-per-line .line-marker\").style(\"opacity\",\"1\");}).on(\"mousemove\",function(){var xy=d3.mouse(d3.event.currentTarget);// let x0 = timeFormat(x.invert(xy[0]));\n// let mouseIndex = bisectDate(chartData, x0, 1);\nvar x0=x.invert(xy[0]);var mouseIndex=justBisect(chartData,x0,1);var d0=chartData[mouseIndex-1];var d1=chartData[mouseIndex];// lastValidDataPreviousYear = findlastValidDataCurrentYear(d0[yLineOne], d1[yLineOne], d0, lastValidDataPreviousYear, chartData[currentMonth - 1]);\n// console.log('i am x0, d0[xAxisKeyName], d1,', x0, d0[xAxisKeyName], d1)\nlastValidDataCurrentYear=findlastValidDataCurrentYear(d0[yLineTwo],d1[yLineTwo],d0,lastValidDataCurrentYear,chartData[currentMonth-1]);// console.log('i am x0, d0[xAxisKeyName], d1, lastValidDataCurrentYear', x0, d0[xAxisKeyName], d1, lastValidDataCurrentYear)\nvar d;if(d1!==undefined){d=x0-d0[xAxisKeyName]>d1[xAxisKeyName]-x0?d1:d0;// d = x0 - d0[xAxisKeyName] > d1[xAxisKeyName] - x0 ? d1 : d0;\n}else{d=d0;}lineTrace.attr(\"transform\",\"translate(\"+x(d[xAxisKeyName])+\",0)\");marker.attr(\"transform\",\"translate(\"+x(d[xAxisKeyName])+\",\"+y(d[yLineOne])+\")\");// marker.attr('transform', d[yLineOne] !== null ? 'translate(' + x(d[xAxisKeyName]) + ',' + y(d[yLineOne]) + ')' : 'translate(' + x(lastValidDataPreviousYear[xAxisKeyName]) + ',' + y(lastValidDataPreviousYear[yLineOne]) + ')');\nmarker2.attr(\"transform\",d[yLineTwo]!==null?\"translate(\"+x(d[xAxisKeyName])+\",\"+y(d[yLineTwo])+\")\":\"translate(\"+x(lastValidDataCurrentYear[xAxisKeyName])+\",\"+y(lastValidDataCurrentYear[yLineTwo])+\")\");YOYdiff=getLineDiffValue(d[yLineTwo],d[yLineOne],YOYdiff);var YOYdiffColor=getYOYdiffColor(YOYdiff);// (d[yLineTwo] == null) ? YOYdiff = null : YOYdiff = numberFormatFn(d[yLineTwo] - d[yLineOne]);\nvar l1text=d[yLineOne]!==null?numberFormatFn(d[yLineOne]):\"\";var l2text=d[yLineTwo]!==null?numberFormatFn(d[yLineTwo]):\"\";YOYdiff=YOYdiff!==null?numberFormatFn(YOYdiff):\"\";lineOneText.text(l1text);lineTwoText.text(l2text);dateText.text(timeFormat(d[xAxisKeyName]));YOYText.text(YOYdiff);YOYText.attr(\"class\",YOYdiffColor);d3.select(\".mouse-line.x\").attr(\"y2\",height);}).attr(\"class\",\"totalRect\").attr(\"fill\",\"none\").attr(\"x\",0).attr(\"pointer-events\",\"all\").attr(\"width\",width).attr(\"transform\",\"translate(0,0)\").attr(\"height\",height).transition().duration(500);//////////////////////// Set the data on load ////////////////////////\nd3.set().add(chartData[chartData.length-1]);var d=chartData[chartData.length-1];lineTrace.attr(\"transform\",\"translate(\"+x(d[xAxisKeyName])+\",0)\");marker.attr(\"transform\",\"translate(\"+x(d[xAxisKeyName])+\",\"+y(d[yLineOne])+\")\");marker2.attr(\"transform\",\"translate(\"+x(d[xAxisKeyName])+\",\"+y(d[yLineTwo])+\")\");YOYdiff=getLineDiffValue(d[yLineTwo],d[yLineOne],YOYdiff);var YOYdiffColor=getYOYdiffColor(YOYdiff);lineOneText.text(numberFormatFn(d[yLineOne]));lineTwoText.text(numberFormatFn(d[yLineTwo]));dateText.text(timeFormat(d[xAxisKeyName]));YOYText.text(numberFormatFn(YOYdiff));YOYText.attr(\"class\",YOYdiffColor);d3.select(\".mouse-line.x\").attr(\"y2\",height);}useEffect(function(){createChart(chartData,\"y2018\",\"y2019\",numberFormatFn,\"month\");},[]);return React.createElement(\"div\",{ref:chart});}","map":{"version":3,"sources":["/Users/amandainnis/amandainnis.github.io/amandainnis.github.io/src/components/reusable/LineChartCV.js"],"names":["React","createRef","useState","useRef","useEffect","d3","LineChartCV","lineChartData","y2018","y2019","month","chart","chartContainer","maxVal","defaultHeight","containerElement","chartData","setChartData","numberFormatFn","d","timeFormat","getCurrentMonth","date","Date","currentMonthNumber","getMonth","findlastValidDataCurrentYear","currVal","nextVal","currentObj","lastValid","dataArraySetPoint","undefined","getLineDiffValue","currYear","prevYear","getYOYdiffColor","YOY","getMaxVal","myData","yLineOne","yLineTwo","tempArr","i","length","push","temp2018max","reduce","a","b","Math","max","temp2018min","min","createChart","xAxisKeyName","lastValidDataCurrentYear","YOYdiff","current","innerHTML","tempMinMax","minVal","currentMonth","margin","top","right","bottom","left","width","Number","isNaN","parseInt","select","style","height","justBisect","bisector","x","scaleLinear","range","y","xAxis","axisBottom","ticks","tickFormat","tickPadding","yAxis","axisRight","lineOne","line","defined","lineTwo","CVsvg","append","attr","forEach","sort","domain","datum","transition","duration","call","lineTrace","marker","marker2","tooltipDiv","dateContainer","text","dateText","lineOneTextContainer","lineOneText","lineTwoTextContainer","lineTwoText","YOYContainer","YOYText","on","selectAll","xy","mouse","event","currentTarget","x0","invert","mouseIndex","d0","d1","YOYdiffColor","l1text","l2text","set","add"],"mappings":"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","sourcesContent":["import React, { createRef, useState, useRef, useEffect } from \"react\";\nimport * as d3 from \"d3\";\n\nexport default function LineChartCV() {\n  const lineChartData = [\n    { y2018: 36, y2019: 56, month: 1 },\n    { y2018: 47, y2019: 99, month: 2 },\n    { y2018: 80, y2019: 105, month: 3 },\n    { y2018: 90, y2019: 115, month: 4 },\n    { y2018: 120, y2019: 135, month: 5 }\n  ];\n  const chart = createRef();\n  const chartContainer = createRef();\n\n  const maxVal = useRef();\n  const defaultHeight = 220;\n  var containerElement;\n\n  const [chartData, setChartData] = useState(lineChartData);\n  // this is where you want the selected bar group to start onInit--tooltip and highlight would start here\n  // in most cases, we are starting with the current month\n  // @Input(\"barIndexSetpoint\") barIndexSetpoint;\n\n  // this is the function to format time values of x axis\n  // @Input(\"timeFormatFn\") timeFormatFn;\n\n  // constructor() {\n  //   this.subs.sink = fromEvent(window, \"resize\").pipe(debounceTime(200)).subscribe(() => this.createChart());\n  // }\n\n  function numberFormatFn(d) {\n    return d;\n  }\n  function timeFormat(d) {\n    if (d == 1) {\n      return \"Jan\";\n    } else if (d == 2) {\n      return \"Feb\";\n    } else if (d == 3) {\n      return \"Mar\";\n    } else if (d == 4) {\n      return \"Apr\";\n    } else if (d == 5) {\n      return \"May\";\n    } else if (d == 6) {\n      return \"Jun\";\n    } else if (d == 7) {\n      return \"Jul\";\n    } else if (d == 8) {\n      return \"Aug\";\n    } else if (d == 9) {\n      return \"Sep\";\n    } else if (d == 10) {\n      return \"Oct\";\n    } else if (d == 11) {\n      return \"Nov\";\n    } else {\n      return \"\";\n    }\n  }\n\n  function getCurrentMonth() {\n    const date = new Date();\n    const currentMonthNumber = date.getMonth() + 1;\n    //console.log('i am current month number', currentMonthNumber);\n    return currentMonthNumber;\n  }\n\n  function findlastValidDataCurrentYear(\n    currVal,\n    nextVal,\n    currentObj,\n    lastValid,\n    dataArraySetPoint\n  ) {\n    if (nextVal == null && currVal !== null) {\n      lastValid = currentObj;\n      // console.log('nextVal == null && currVal !== null, i am currentObj', nextVal, currVal, currentObj)\n      return lastValid;\n    } else if (nextVal == null && currVal == null && lastValid == undefined) {\n      // console.log('nextVal == null && currVal == null && lastValid == undefined', nextVal, currVal, lastValid);\n      lastValid = dataArraySetPoint;\n      //console.log('i am now defined', lastValid);\n      return lastValid;\n    } else {\n      // console.log('lastValid, nextVal, currVal, currentObj', lastValid, nextVal, currVal, currentObj)\n      lastValid = lastValid;\n      return lastValid;\n    }\n  }\n\n  function getLineDiffValue(currYear, prevYear) {\n    return currYear == null || prevYear == null ? null : currYear - prevYear;\n  }\n  function getYOYdiffColor(YOY) {\n    if (YOY < 0) {\n      return \"YOYred\";\n    } else {\n      return \"YOYgreen\";\n    }\n  }\n\n  // Math.min will assign null values to 0 so need to filter out null if want min to be actual min,\n  // but it may look better to have an actual zero\n  function getMaxVal(myData, yLineOne, yLineTwo) {\n    let tempArr = [];\n    for (let i = 0; i < myData.length; i++) {\n      tempArr.push(myData[i][yLineOne], myData[i][yLineTwo]);\n      if (myData[i][yLineOne] !== null) tempArr.push(myData[i][yLineOne]);\n      if (myData[i][yLineTwo] !== null) tempArr.push(myData[i][yLineTwo]);\n    }\n    let temp2018max = tempArr.reduce((a, b) => Math.max(a, b));\n    let temp2018min = tempArr.reduce((a, b) => Math.min(a, b));\n    return { min: temp2018min, max: temp2018max };\n  }\n\n  function createChart(\n    chartData,\n    yLineOne,\n    yLineTwo,\n    numberFormatFn,\n    xAxisKeyName\n  ) {\n    let lastValidDataCurrentYear;\n    //let lastValidDataPreviousYear;\n    let YOYdiff;\n    containerElement = chart.current;\n    containerElement.innerHTML = \"\";\n    let tempMinMax = getMaxVal(chartData, yLineOne, yLineTwo);\n    let minVal = tempMinMax.min;\n    let maxVal = tempMinMax.max;\n    let currentMonth = getCurrentMonth();\n    let margin = { top: 20, right: 60, bottom: 0, left: 10 };\n    //////////////////////// Establish the reused vals and the bound functions  ////////////////////////\n    let width = Number.isNaN(\n      parseInt(d3.select(containerElement).style(\"width\"))\n    )\n      ? 0\n      : parseInt(d3.select(containerElement).style(\"width\")) -\n        margin.left -\n        margin.right;\n    let height = 220 - margin.top;\n    // translates a function to d3, passes angular scope into d3\n    // tell format func that the function with \"this\" should be asscoiated with the currect ts component\n\n    //let bisectDate = d3.bisector((d) => timeFormat(d[xAxisKeyName])).left; // this would return the month, but we aren't using it right now\n    let justBisect = d3.bisector(d => d[xAxisKeyName]).left;\n\n    //////////////////////// Set the scales  ////////////////////////\n\n    let x = d3.scaleLinear().range([0, width]);\n\n    let y = d3.scaleLinear().range([height, 0]);\n\n    //////////////////////// Set the axis ////////////////////////\n\n    let xAxis = d3\n      .axisBottom(x)\n      .ticks(chartData.length)\n      .tickFormat(function(d) {\n        // console.log(d);\n        return timeFormat(d);\n      })\n      .tickPadding(6);\n\n    let yAxis = d3\n      .axisRight(y)\n      .tickFormat(d => {\n        return numberFormatFn(d);\n      })\n      // .ticks(6)\n      .tickPadding(6);\n\n    //////////////////////// Define the lines and/or areas  ////////////////////////\n\n    const lineOne = d3\n      .line()\n      .defined(function(d) {\n        if (d[yLineOne] !== null) {\n          return d[yLineOne];\n        }\n      })\n      .x(d => x(d[xAxisKeyName]))\n      .y(d => y(d[yLineOne]));\n\n    const lineTwo = d3\n      .line()\n      .defined(function(d) {\n        if (d[yLineTwo] !== null) {\n          return d[yLineTwo];\n        }\n      })\n      .x(d => x(d[xAxisKeyName]))\n      .y(d => y(d[yLineTwo]));\n\n    //////////////////////// Define parent SVG  ////////////////////////\n\n    const CVsvg = d3\n      .select(containerElement)\n      .append(\"svg\")\n      .attr(\"width\", \"100%\")\n      .attr(\"height\", height + margin.top + margin.bottom + 40)\n      .append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    //////////////////////// Loop through / sort data  ////////////////////////\n\n    chartData.forEach(d => {\n      d = +d;\n    });\n\n    chartData.sort((a, b) => a[xAxisKeyName] - b[xAxisKeyName]);\n\n    //////////////////////// Set the domains  ////////////////////////\n\n    x.domain([\n      parseInt(d3.min(chartData, d => d[xAxisKeyName])),\n      parseInt(d3.max(chartData, d => d[xAxisKeyName]))\n    ]);\n    y.domain([minVal, maxVal]);\n\n    //////////////////////// Append the lines / areas  ////////////////////////\n\n    CVsvg.append(\"path\")\n      .datum(chartData)\n      .attr(\"class\", \"lineOne line\")\n      .attr(\"d\", lineOne)\n      .transition()\n      .duration(500);\n    CVsvg.append(\"path\")\n      .datum(chartData)\n      .attr(\"class\", \"lineTwo line\")\n      .attr(\"d\", lineTwo)\n      .transition()\n      .duration(500);\n\n    ///////////////////////  Add the X & Y Axis  ////////////////////////\n\n    CVsvg.append(\"g\")\n      .attr(\"class\", \"yAxis\")\n      .attr(\"transform\", \"translate(\" + (width + 6) + \",0)\")\n      .call(yAxis);\n\n    CVsvg.append(\"g\")\n      .attr(\"class\", \"xAxis\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(xAxis);\n\n    //////////////////////// Add Line Tracing on mouse and markers   ////////////////////////\n\n    const lineTrace = CVsvg.append(\"line\")\n      .attr(\"class\", \"mouse-line x\")\n      .style(\"opacity\", 0.5)\n      .attr(\"y1\", 0)\n      .attr(\"y2\", height);\n\n    const marker = CVsvg.append(\"g\").attr(\"class\", \"marker\");\n\n    marker\n      .append(\"circle\")\n      .attr(\"class\", \"line-marker lineOne\")\n      .transition()\n      .duration(500)\n      .attr(\"r\", 5);\n\n    const marker2 = CVsvg.append(\"g\").attr(\"class\", \"marker\");\n    marker2\n      .append(\"circle\")\n      .attr(\"class\", \"line-marker lineTwo\")\n      .transition()\n      .duration(500)\n      .attr(\"r\", 5);\n\n    //////////////////////// Tooltip  ////////////////////////\n\n    const tooltipDiv = d3\n      .select(containerElement)\n      .append(\"div\")\n      .attr(\"class\", \"tooltipDiv\");\n    const dateContainer = tooltipDiv\n      .append(\"div\")\n      .attr(\"class\", \"text-container\");\n    dateContainer\n      .append(\"div\")\n      .attr(\"class\", \"label-style mr-1\")\n      .text(\"Month\");\n    const dateText = dateContainer.append(\"div\").attr(\"class\", \"value-text\");\n    const lineOneTextContainer = tooltipDiv\n      .append(\"div\")\n      .attr(\"class\", \"text-container\");\n    lineOneTextContainer\n      .append(\"div\")\n      .attr(\"class\", \"label-style mr-1\")\n      .text(\"2018\");\n    lineOneTextContainer.append(\"div\").attr(\"class\", \"dot lineOne\");\n\n    const lineOneText = lineOneTextContainer\n      .append(\"div\")\n      .attr(\"class\", \"value-text\");\n    const lineTwoTextContainer = tooltipDiv\n      .append(\"div\")\n      .attr(\"class\", \"text-container\");\n    lineTwoTextContainer\n      .append(\"div\")\n      .attr(\"class\", \"label-style mr-1\")\n      .text(\"2019\");\n    lineTwoTextContainer.append(\"div\").attr(\"class\", \"dot lineTwo\");\n\n    const lineTwoText = lineTwoTextContainer\n      .append(\"div\")\n      .attr(\"class\", \"value-text\");\n    const YOYContainer = tooltipDiv\n      .append(\"div\")\n      .attr(\"class\", \"text-container\");\n    YOYContainer.append(\"div\")\n      .attr(\"class\", \"label-style mr-1\")\n      .text(\"YOY\");\n    const YOYText = YOYContainer.append(\"div\");\n\n    //////////////////////// Add Rect to Capture Mouse Movements  ////////////////////////\n\n    CVsvg.append(\"rect\")\n      .on(\"mouseover\", () => {\n        lineTrace.style(\"display\", null);\n        d3.select(\".mouse-line\").style(\"opacity\", \"1\");\n        d3.selectAll(\".mouse-per-line .line-marker\").style(\"opacity\", \"1\");\n      })\n      .on(\"mousemove\", () => {\n        let xy = d3.mouse(d3.event.currentTarget);\n        // let x0 = timeFormat(x.invert(xy[0]));\n        // let mouseIndex = bisectDate(chartData, x0, 1);\n        let x0 = x.invert(xy[0]);\n        let mouseIndex = justBisect(chartData, x0, 1);\n        let d0 = chartData[mouseIndex - 1];\n        let d1 = chartData[mouseIndex];\n        // lastValidDataPreviousYear = findlastValidDataCurrentYear(d0[yLineOne], d1[yLineOne], d0, lastValidDataPreviousYear, chartData[currentMonth - 1]);\n        // console.log('i am x0, d0[xAxisKeyName], d1,', x0, d0[xAxisKeyName], d1)\n        lastValidDataCurrentYear = findlastValidDataCurrentYear(\n          d0[yLineTwo],\n          d1[yLineTwo],\n          d0,\n          lastValidDataCurrentYear,\n          chartData[currentMonth - 1]\n        );\n        // console.log('i am x0, d0[xAxisKeyName], d1, lastValidDataCurrentYear', x0, d0[xAxisKeyName], d1, lastValidDataCurrentYear)\n        let d;\n        if (d1 !== undefined) {\n          d = x0 - d0[xAxisKeyName] > d1[xAxisKeyName] - x0 ? d1 : d0;\n          // d = x0 - d0[xAxisKeyName] > d1[xAxisKeyName] - x0 ? d1 : d0;\n        } else {\n          d = d0;\n        }\n\n        lineTrace.attr(\"transform\", \"translate(\" + x(d[xAxisKeyName]) + \",0)\");\n        marker.attr(\n          \"transform\",\n          \"translate(\" + x(d[xAxisKeyName]) + \",\" + y(d[yLineOne]) + \")\"\n        );\n        // marker.attr('transform', d[yLineOne] !== null ? 'translate(' + x(d[xAxisKeyName]) + ',' + y(d[yLineOne]) + ')' : 'translate(' + x(lastValidDataPreviousYear[xAxisKeyName]) + ',' + y(lastValidDataPreviousYear[yLineOne]) + ')');\n\n        marker2.attr(\n          \"transform\",\n          d[yLineTwo] !== null\n            ? \"translate(\" + x(d[xAxisKeyName]) + \",\" + y(d[yLineTwo]) + \")\"\n            : \"translate(\" +\n                x(lastValidDataCurrentYear[xAxisKeyName]) +\n                \",\" +\n                y(lastValidDataCurrentYear[yLineTwo]) +\n                \")\"\n        );\n\n        YOYdiff = getLineDiffValue(d[yLineTwo], d[yLineOne], YOYdiff);\n        let YOYdiffColor = getYOYdiffColor(YOYdiff);\n        // (d[yLineTwo] == null) ? YOYdiff = null : YOYdiff = numberFormatFn(d[yLineTwo] - d[yLineOne]);\n        let l1text = d[yLineOne] !== null ? numberFormatFn(d[yLineOne]) : \"\";\n        let l2text = d[yLineTwo] !== null ? numberFormatFn(d[yLineTwo]) : \"\";\n        YOYdiff = YOYdiff !== null ? numberFormatFn(YOYdiff) : \"\";\n        lineOneText.text(l1text);\n        lineTwoText.text(l2text);\n        dateText.text(timeFormat(d[xAxisKeyName]));\n        YOYText.text(YOYdiff);\n        YOYText.attr(\"class\", YOYdiffColor);\n\n        d3.select(\".mouse-line.x\").attr(\"y2\", height);\n      })\n      .attr(\"class\", \"totalRect\")\n      .attr(\"fill\", \"none\")\n      .attr(\"x\", 0)\n      .attr(\"pointer-events\", \"all\")\n      .attr(\"width\", width)\n      .attr(\"transform\", \"translate(0,0)\")\n      .attr(\"height\", height)\n      .transition()\n      .duration(500);\n\n    //////////////////////// Set the data on load ////////////////////////\n\n    d3.set().add(chartData[chartData.length - 1]);\n    let d = chartData[chartData.length - 1];\n    lineTrace.attr(\"transform\", \"translate(\" + x(d[xAxisKeyName]) + \",0)\");\n\n    marker.attr(\n      \"transform\",\n      \"translate(\" + x(d[xAxisKeyName]) + \",\" + y(d[yLineOne]) + \")\"\n    );\n    marker2.attr(\n      \"transform\",\n      \"translate(\" + x(d[xAxisKeyName]) + \",\" + y(d[yLineTwo]) + \")\"\n    );\n\n    YOYdiff = getLineDiffValue(d[yLineTwo], d[yLineOne], YOYdiff);\n    let YOYdiffColor = getYOYdiffColor(YOYdiff);\n\n    lineOneText.text(numberFormatFn(d[yLineOne]));\n    lineTwoText.text(numberFormatFn(d[yLineTwo]));\n    dateText.text(timeFormat(d[xAxisKeyName]));\n    YOYText.text(numberFormatFn(YOYdiff));\n    YOYText.attr(\"class\", YOYdiffColor);\n\n    d3.select(\".mouse-line.x\").attr(\"y2\", height);\n  }\n\n  useEffect(() => {\n    createChart(chartData, \"y2018\", \"y2019\", numberFormatFn, \"month\");\n  }, []);\n\n  return <div ref={chart}></div>;\n}\n"]},"metadata":{},"sourceType":"module"}